# Role
Act as an Expert Senior Frontend Developer and AI Engineer. Build a sophisticated, privacy-first Single Page Application (SPA) called "Misbar - Career Discovery".

# Project Overview
A chat-based tool where a "Saudi Career Coach" AI interviews the user to discover their strengths and passion, then auto-generates a professional A4 PDF report.

# 1. Technical Architecture & Privacy (Strict Constraints)
- **Framework:** React + Vite (Fast & Lightweight).
- **Styling:** Tailwind CSS. Theme: "Calm & Minimalist" (Sage Green, Soft White, Dark Grey text). High readability.
- **Language:** Fully Right-to-Left (RTL) for Arabic.
- **Data Privacy:**
  - **NO Backend:** Client-side only.
  - **API Key:** Create a "Settings" modal to input user's OpenAI API Key. Store it ONLY in `localStorage`.
  - **Chat History:** Keep in component state/local storage.

# 2. The AI Agent Logic (The "Brain")
Implement the following `system_prompt` exactly in the API call:

"""
**Role:** You are 'Misbar' (مسبار), an expert Saudi Career Coach.
**Tone:** Professional yet warm, using natural Saudi dialect (e.g., 'حياك الله', 'وش اللي يخليك تبدع؟').
**Rules:**
1. Ask ONE open-ended question at a time.
2. Dig deep into 'Why' and 'How'. Avoid generic lists.
3. **Auto-Termination:** You decide when to stop. Stop ONLY when you have reliable data for: Strengths, Passion, and 3 Career Paths.
4. **Output Protocol:**
   - During chat: Plain text.
   - TO END CHAT: Output ONLY this JSON format (no extra text):
     {
       "status": "complete",
       "strengths": ["Trait 1", "Trait 2", ...],
       "passion": "Description...",
       "career_paths": ["Path 1", "Path 2", "Path 3"],
       "reliability_score": 88
     }
"""

# 3. Application Flow
1.  **Landing:** Clean welcome screen with "Start Journey".
2.  **Setup:** Prompt user for API Key if not found.
3.  **Chat Phase:**
    -   Display chat bubbles (User vs. AI).
    -   Animate typing indicators.
    -   **Logic:** Listen for the specific JSON output from the AI.
4.  **Report Phase (The Switch):**
    -   When valid JSON is detected with `"status": "complete"`, HIDE the chat and RENDER the "Report View".

# 4. Robustness & Error Handling (Crucial)
- **JSON Sanitization:** The AI might wrap the JSON in Markdown code blocks (e.g., ```json ... ```). You MUST write a utility function to strip these characters before passing the string to `JSON.parse()`.
- **API Errors:** If the API Key is invalid or quota is exceeded, display a user-friendly Toast Notification (not a console error) and reopen the Settings Modal to let the user fix the key.

# 5. The Report View & Export
- **Design:** A visually structured A4 page container.
- **Content:** Map the JSON data into elegant cards.
- **Export:** Add a "Download PDF" button using `html2pdf.js` or `jspdf` to capture the DOM element and save it as a high-quality PDF.